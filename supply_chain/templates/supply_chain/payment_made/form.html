{% extends 'index.html' %}
{% load static %}
{% load widget_tweaks %}
{% block content %}
    <div class="flex h-full flex-col">
        <form action="" method="post" class="flex flex-col h-full">
            {% csrf_token %}
            <!-- Header -->
            <div class="flex-none bg-white border-b py-4 px-5">
                <div class="flex justify-between items-center">
                    <h1 class="text-xl font-normal text-gray-900 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg"
                             viewBox="0 0 20 20"
                             fill="currentColor"
                             class="size-5 mr-2">
                            <path d="M9.25 13.25a.75.75 0 0 0 1.5 0V4.636l2.955 3.129a.75.75 0 0 0 1.09-1.03l-4.25-4.5a.75.75 0 0 0-1.09 0l-4.25 4.5a.75.75 0 1 0 1.09 1.03L9.25 4.636v8.614Z" />
                            <path d="M3.5 12.75a.75.75 0 0 0-1.5 0v2.5A2.75 2.75 0 0 0 4.75 18h10.5A2.75 2.75 0 0 0 18 15.25v-2.5a.75.75 0 0 0-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5Z" />
                        </svg>
                        Record Payment
                    </h1>
                    <a href="{% url 'payments' %}"
                       class="p-2 text-gray-500 hover:text-gray-600 transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg"
                             fill="none"
                             viewBox="0 0 24 24"
                             stroke-width="1.5"
                             stroke="currentColor"
                             class="size-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                        </svg>
                    </a>
                </div>
            </div>
            <!-- Error Section -->
            {% if paymentform.errors or paymentform.non_field_errors %}
                <div class="bg-red-50 border-b border-red-200 px-5 py-3">
                    <div class="max-w-4xl space-y-2">
                        <!-- Non-field errors -->
                        {% if paymentform.non_field_errors %}
                            {% for error in paymentform.non_field_errors %}
                                <div class="flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg"
                                         viewBox="0 0 20 20"
                                         fill="currentColor"
                                         class="size-4 text-red-500 mr-2 flex-shrink-0">
                                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                                    </svg>
                                    <p class="text-sm text-red-700">{{ error }}</p>
                                </div>
                            {% endfor %}
                        {% endif %}
                        <!-- Field errors -->
                        {% for field in paymentform %}
                            {% if field.errors %}
                                {% for error in field.errors %}
                                    <div class="flex items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg"
                                             viewBox="0 0 20 20"
                                             fill="currentColor"
                                             class="size-4 text-red-500 mr-2 flex-shrink-0">
                                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                                        </svg>
                                        <p class="text-sm text-red-700">
                                            <strong>{{ field.label }}:</strong> {{ error }}
                                        </p>
                                    </div>
                                {% endfor %}
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>
            {% endif %}
            <!-- Main Content - Scrollable -->
            <div class="flex-1 overflow-y-auto px-5 py-6 bg-gray-50 pb-20">
                <div class="mt-5 py-5 max-w-2xl space-y-6">
                    <!-- Purchase Order -->
                    <div class="flex items-center gap-4">
                        <label for="{{ paymentform.purchase_order.id_for_label }}"
                               class="text-sm font-normal text-red-600 w-32 flex-shrink-0">Purchase Order*</label>
                        <div class="relative flex flex-1">
                            {% render_field paymentform.purchase_order class="w-full font-light px-3 py-1.5 bg-white border border-gray-300 rounded-l-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500 outline-none select2-enabled" %}
                            <a href="{% url 'add_po' %}?next={{ request.path }}"
                               class="inline-flex items-center justify-center bg-blue-500 text-white rounded-r-md px-2 hover:bg-blue-600 transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                     fill="none"
                                     viewBox="0 0 24 24"
                                     stroke-width="1.5"
                                     stroke="currentColor"
                                     class="size-6">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                                </svg>
                            </a>
                        </div>
                    </div>
                    <!-- Payment Date -->
                    <div class="flex items-center gap-4">
                        <label for="{{ paymentform.payment_method.id_for_label }}"
                               class="text-sm font-normal text-gray-600 w-32 flex-shrink-0">Payment Date</label>
                        <div class="flex-1">
                            {% render_field paymentform.payment_date class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 focus:outline-none block w-full py-1.5 px-2.5" %}
                        </div>
                    </div>
                    <!-- Amount -->
                    <div class="flex items-center gap-4">
                        <label for="{{ paymentform.amount_paid.id_for_label }}"
                               class="text-sm font-normal text-red-600 w-32 flex-shrink-0">Amount*</label>
                        <div class="relative flex flex-1">
                            <p class="inline-flex items-center border border-gray-300 font-light justify-center bg-gray-50 text-gray-900 rounded-l-md px-3 py-1.5">
                                NGN
                            </p>
                            {% render_field paymentform.amount_paid class="bg-white border border-gray-300 text-gray-900 text-sm rounded-r-md focus:ring-blue-500 focus:border-blue-500 focus:outline-none block w-full py-1.5 px-2.5" min="10000" step="1000" placeholder="10,000.00" %}
                        </div>
                    </div>
                    <!-- Payment Method -->
                    <div class="flex items-center gap-4">
                        <label for="{{ paymentform.payment_method.id_for_label }}"
                               class="text-sm font-normal text-red-600 w-32 flex-shrink-0">Payment Mode*</label>
                        <div class="flex-1">
                            {% render_field paymentform.payment_method class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 focus:outline-none block w-full py-1.5 px-2.5" %}
                        </div>
                    </div>
                    <!-- Remark -->
                    <div class="flex items-start gap-4">
                        <label for="{{ paymentform.remark.id_for_label }}"
                               class="text-sm font-normal text-gray-600 w-32 flex-shrink-0 pt-1">Remark</label>
                        <div class="flex-1">
                            {% render_field paymentform.remark class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 focus:outline-none block w-full py-1.5 px-2.5" rows="3" placeholder="Enter payment details" %}
                        </div>
                    </div>
                </div>
            </div>
            <!-- Sticky Footer with Form Buttons -->
            {% url 'payments' as cancel_url %}
            {% include 'partials/form_buttons.html' with cancel_url=cancel_url %}
        </form>
    </div>
{% endblock content %}
